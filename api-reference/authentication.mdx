---
title: Authentication
description: "Learn how to authenticate with the ACME Company API using API keys and bearer tokens."
---

The ACME Company API uses multiple authentication methods to ensure secure access to your data. Choose the method that best fits your use case and security requirements.

## Authentication Methods

### API Key Authentication

The simplest way to authenticate with the ACME Company API is using an API key passed in the request header.

**Header format**:
```
X-API-Key: your_api_key_here
```

**Example request**:
```bash
curl -X GET "https://api.acme.com/v1/pets" \
  -H "X-API-Key: pk_live_51H9X2LKjI8mZ2gH8vK3nR7..."
```

<CodeGroup tabs="cURL,JavaScript,Python,Go">
```bash
# Using cURL with API key
curl -X GET "https://api.acme.com/v1/pets" \
  -H "X-API-Key: pk_live_51H9X2LKjI8mZ2gH8vK3nR7..." \
  -H "Content-Type: application/json"
```

```javascript
// Using JavaScript fetch with API key
const response = await fetch('https://api.acme.com/v1/pets', {
  headers: {
    'X-API-Key': 'pk_live_51H9X2LKjI8mZ2gH8vK3nR7...',
    'Content-Type': 'application/json'
  }
});

const pets = await response.json();
```

```python
# Using Python requests with API key
import requests

headers = {
    'X-API-Key': 'pk_live_51H9X2LKjI8mZ2gH8vK3nR7...',
    'Content-Type': 'application/json'
}

response = requests.get(
    'https://api.acme.com/v1/pets',
    headers=headers
)

pets = response.json()
```

```go
// Using Go with API key
package main

import (
    "fmt"
    "io"
    "net/http"
)

func main() {
    client := &http.Client{}
    req, _ := http.NewRequest("GET", "https://api.acme.com/v1/pets", nil)
    
    req.Header.Add("X-API-Key", "pk_live_51H9X2LKjI8mZ2gH8vK3nR7...")
    req.Header.Add("Content-Type", "application/json")
    
    resp, err := client.Do(req)
    if err != nil {
        fmt.Println("Error:", err)
        return
    }
    defer resp.Body.Close()
    
    body, _ := io.ReadAll(resp.Body)
    fmt.Println(string(body))
}
```
</CodeGroup>

### Bearer Token Authentication (JWT)

For more secure applications, use JWT bearer tokens obtained through the authentication endpoint.

**Header format**:
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Authentication flow**:

1. **Obtain a token** by calling the `/auth/login` endpoint
2. **Include the token** in the `Authorization` header for subsequent requests
3. **Refresh the token** before it expires (tokens are valid for 1 hour)

<ExpandableGroup>
<Expandable title="Step 1: Login and Get Token" default-open="true">

**Endpoint**: `POST /auth/login`

**Request body**:
```json
{
  "username": "your_username",
  "password": "your_password"
}
```

**Example request**:
<CodeGroup tabs="cURL,JavaScript,Python">
```bash
curl -X POST "https://api.acme.com/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "john.doe",
    "password": "secure_password_123"
  }'
```

```javascript
const loginResponse = await fetch('https://api.acme.com/v1/auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    username: 'john.doe',
    password: 'secure_password_123'
  })
});

const { token, user, expiresIn } = await loginResponse.json();
console.log('Token expires in:', expiresIn, 'seconds');
```

```python
import requests

login_data = {
    'username': 'john.doe',
    'password': 'secure_password_123'
}

response = requests.post(
    'https://api.acme.com/v1/auth/login',
    json=login_data
)

auth_info = response.json()
token = auth_info['token']
expires_in = auth_info['expiresIn']
```
</CodeGroup>

**Successful response**:
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 123,
    "username": "john.doe",
    "email": "john.doe@acme.com"
  },
  "expiresIn": 3600
}
```

</Expandable>

<Expandable title="Step 2: Use Token for API Calls" default-open="false">

Once you have a token, include it in the `Authorization` header:

<CodeGroup tabs="JavaScript,Python,cURL">
```javascript
// Store the token for reuse
const apiToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';

// Use token for authenticated requests
const response = await fetch('https://api.acme.com/v1/pets', {
  headers: {
    'Authorization': `Bearer ${apiToken}`,
    'Content-Type': 'application/json'
  }
});

// Handle token expiration
if (response.status === 401) {
  // Token expired, need to re-authenticate
  console.log('Token expired, please login again');
}
```

```python
# Store token for reuse
api_token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'

# Create headers with token
headers = {
    'Authorization': f'Bearer {api_token}',
    'Content-Type': 'application/json'
}

# Make authenticated request
response = requests.get(
    'https://api.acme.com/v1/pets',
    headers=headers
)

# Handle token expiration
if response.status_code == 401:
    print('Token expired, please re-authenticate')
```

```bash
# Store token in variable for reuse
TOKEN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

# Use token in requests
curl -X GET "https://api.acme.com/v1/pets" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json"
```
</CodeGroup>

</Expandable>

<Expandable title="Step 3: Handle Token Refresh" default-open="false">

Tokens expire after 1 hour. Implement automatic token refresh in your application:

```javascript
class PetStoreAPI {
  constructor(username, password) {
    this.username = username;
    this.password = password;
    this.token = null;
    this.tokenExpiry = null;
  }

  async authenticate() {
    const response = await fetch('https://api.acme.com/v1/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        username: this.username,
        password: this.password
      })
    });

    const data = await response.json();
    this.token = data.token;
    this.tokenExpiry = Date.now() + (data.expiresIn * 1000);
    
    return this.token;
  }

  async getValidToken() {
    // Check if token exists and hasn't expired (with 5-minute buffer)
    if (!this.token || Date.now() > (this.tokenExpiry - 300000)) {
      await this.authenticate();
    }
    return this.token;
  }

  async apiRequest(endpoint, options = {}) {
    const token = await this.getValidToken();
    
    const response = await fetch(`https://api.acme.com/v1${endpoint}`, {
      ...options,
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json',
        ...options.headers
      }
    });

    if (response.status === 401) {
      // Force token refresh and retry once
      this.token = null;
      const newToken = await this.getValidToken();
      
      return fetch(`https://api.acme.com/v1${endpoint}`, {
        ...options,
        headers: {
          'Authorization': `Bearer ${newToken}`,
          'Content-Type': 'application/json',
          ...options.headers
        }
      });
    }

    return response;
  }
}

// Usage
const api = new PetStoreAPI('john.doe', 'password123');
const response = await api.apiRequest('/pets');
const pets = await response.json();
```

</Expandable>
</ExpandableGroup>

## Getting Your API Credentials

### Creating an API Key

<Callout kind="info">
  API keys are perfect for server-side applications and testing. They don't expire but should be kept secure.
</Callout>

1. **Log in to your Pet Store dashboard** at [dashboard.acme.com](https://dashboard.acme.com)
2. **Navigate to Settings → API Keys**
3. **Click "Generate New API Key"**
4. **Give your key a descriptive name** (e.g., "Production Server", "Development Testing")
5. **Copy the key immediately** - it won't be shown again
6. **Store the key securely** in your environment variables

**API key format**:
- **Live keys**: `pk_live_...` (for production use)
- **Test keys**: `pk_test_...` (for development and testing)

<Callout kind="danger">
  **Security warning**: Never commit API keys to version control or expose them in client-side code. Store them as environment variables or in secure key management systems.
</Callout>

### Creating User Accounts

For JWT authentication, you'll need a user account:

1. **Register at the Pet Store platform** or have an admin create your account
2. **Verify your email address** if required
3. **Use your username and password** with the `/auth/login` endpoint
4. **Store the returned JWT token** securely in your application

## Security Best Practices

### Protecting Your Credentials

<ExpandableGroup>
<Expandable title="Environment Variables" default-open="true">

Store credentials in environment variables, not in your code:

**Development (.env file)**:
```bash
# .env file (never commit this!)
PETSTORE_API_KEY=pk_test_51H9X2LKjI8mZ2gH8vK3nR7...
PETSTORE_USERNAME=john.doe
PETSTORE_PASSWORD=secure_password_123
PETSTORE_BASE_URL=https://api.acme.com/v1
```

**Usage in code**:
```javascript
// Load from environment variables
const apiKey = process.env.PETSTORE_API_KEY;
const username = process.env.PETSTORE_USERNAME;
const password = process.env.PETSTORE_PASSWORD;

// Never do this:
// const apiKey = "pk_live_51H9X2LKjI8mZ2gH8vK3nR7..."; ❌
```

**Production deployment**:
- Use your hosting platform's environment variable settings
- Consider using secret management services (AWS Secrets Manager, Azure Key Vault, etc.)
- Rotate credentials regularly

</Expandable>

<Expandable title="Rate Limiting and Error Handling" default-open="false">

Implement proper error handling and respect rate limits:

```javascript
async function makeApiRequest(url, options, retryCount = 0) {
  try {
    const response = await fetch(url, options);
    
    // Handle rate limiting
    if (response.status === 429) {
      const retryAfter = response.headers.get('Retry-After') || 60;
      console.log(`Rate limited. Waiting ${retryAfter} seconds...`);
      
      if (retryCount < 3) {
        await new Promise(resolve => setTimeout(resolve, retryAfter * 1000));
        return makeApiRequest(url, options, retryCount + 1);
      }
      throw new Error('Rate limit exceeded after multiple retries');
    }
    
    // Handle authentication errors
    if (response.status === 401) {
      throw new Error('Invalid credentials or expired token');
    }
    
    // Handle other errors
    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(`API Error: ${errorData.message}`);
    }
    
    return response;
  } catch (error) {
    console.error('API request failed:', error);
    throw error;
  }
}
```

**Rate limits by authentication method**:
- **API Key**: 1000 requests per hour
- **JWT Token**: 5000 requests per hour (higher limit for authenticated users)
- **Unauthenticated**: 100 requests per hour

</Expandable>

<Expandable title="IP Allowlisting (Enterprise)" default-open="false">

Enterprise customers can restrict API access to specific IP addresses:

1. **Contact support** to enable IP allowlisting for your account
2. **Provide your server IP addresses** or IP ranges
3. **Test access** from allowed IPs before going live
4. **Update the allowlist** when your infrastructure changes

**CIDR notation examples**:
```
203.0.113.0/24    # Allows 203.0.113.0 - 203.0.113.255
198.51.100.42/32  # Allows only 198.51.100.42
192.168.1.0/28    # Allows 192.168.1.0 - 192.168.1.15
```

</Expandable>
</ExpandableGroup>

## Error Responses

### Common Authentication Errors

| Status Code | Error Code | Description | Solution |
|-------------|------------|-------------|----------|
| `401` | `INVALID_API_KEY` | API key is invalid or malformed | Check your API key format and regenerate if needed |
| `401` | `EXPIRED_TOKEN` | JWT token has expired | Re-authenticate to get a fresh token |
| `401` | `INVALID_CREDENTIALS` | Username/password combination is incorrect | Verify credentials and account status |
| `403` | `INSUFFICIENT_PERMISSIONS` | Account lacks required permissions | Contact support to upgrade your account |
| `429` | `RATE_LIMIT_EXCEEDED` | Too many requests in time window | Wait for rate limit reset or upgrade plan |

**Example error response**:
```json
{
  "code": "EXPIRED_TOKEN",
  "message": "The provided JWT token has expired",
  "details": {
    "expired_at": "2024-01-15T14:30:00Z",
    "current_time": "2024-01-15T15:45:00Z"
  }
}
```

### Handling Errors Gracefully

```javascript
async function handleApiError(response) {
  const errorData = await response.json();
  
  switch (errorData.code) {
    case 'EXPIRED_TOKEN':
      // Attempt to refresh token
      console.log('Token expired, refreshing...');
      return await refreshToken();
      
    case 'RATE_LIMIT_EXCEEDED':
      // Wait and retry
      const retryAfter = response.headers.get('Retry-After') || 60;
      console.log(`Rate limited, waiting ${retryAfter}s`);
      await new Promise(resolve => setTimeout(resolve, retryAfter * 1000));
      return 'retry';
      
    case 'INVALID_API_KEY':
      // This requires manual intervention
      throw new Error('API key is invalid. Please check your configuration.');
      
    default:
      throw new Error(`API Error: ${errorData.message}`);
  }
}
```

## Testing Authentication

### Quick Test Commands

Verify your authentication is working:

<CodeGroup tabs="Test API Key,Test JWT Login,Test Protected Endpoint">
```bash
# Test API key authentication
curl -X GET "https://api.acme.com/v1/pets" \
  -H "X-API-Key: YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -w "Status: %{http_code}\n"

# Expected: Status 200 with pet data
```

```bash
# Test JWT authentication
curl -X POST "https://api.acme.com/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "your_username",
    "password": "your_password"
  }' \
  -w "Status: %{http_code}\n"

# Expected: Status 200 with token data
```

```bash
# Test protected endpoint with JWT
TOKEN="your_jwt_token_here"

curl -X GET "https://api.acme.com/v1/users" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -w "Status: %{http_code}\n"

# Expected: Status 200 with user data
```
</CodeGroup>

<Callout kind="success">
  **Authentication setup complete!** You're now ready to start making authenticated requests to the ACME Company API. Check out our [Getting Started guide](getting-started) for your first API calls.
</Callout>

---

## What's next?

- **[Getting Started](getting-started)** - Make your first API calls
- **[ACME Company API Reference](/api-reference/petstore-openapi.yaml)** - Explore all available endpoints
- **[Error Handling](../guides/best-practices#error-handling)** - Learn robust error handling patterns
- **[Rate Limits](../guides/best-practices#rate-limiting)** - Understand API usage limits and optimization
